<!DOCTYPE html>
<html lang="en">
    <%- include('./partials/head.ejs') %>

    <body>
        <%- include('./partials/nav.ejs') %>

        <div class="home_content_container">
            <div class="home_content_option_container">
                <div class="home_content_option_text">
                    File :
                </div>

                <div class="home_content_option_box">
                    <select onchange="option_box()" name="home_content_option_box" id="home_content_option_box">
                        <% for(let i = 0; i < list_of_assignment_range_data.weekly.length; i++) {%>
                            <% if (i == list_of_assignment_range_data.weekly.length-1) {%>
                                <option value="W<%= i+1 %>" selected="selected">List Tugas Minggu Ke-<%= i+1 %></option>
                            <% } else {%>
                                <option value="W<%= i+1 %>">List Tugas Minggu Ke-<%= i+1 %></option>
                            <% } %>
                        <% } %>

                        <% for(let i = 0; i < list_of_assignment_range_data.monthly.length; i++) {%>
                            <option value="M<%= i+1 %>">List Tugas Bulan Ke-<%= i+1 %></option>
                        <% } %>

                        <option value="C1">List Tugas Gabunggan</option>
                    </select>
                </div>

            </div>

            <div class="home_content_table_container">
                <table>
                    <thead>
                        <tr>
                            <!-- Number & Name -->
                            <th rowspan="3">No.</th>
                            <th rowspan="3">Name</th>
                            
                            <!-- Week -->
                            <% for(let i = 0; i < list_of_assignment_range_data.weekly.length; i++) {%> 
                                <th class="home_content_table_<%= i+1 %>"  colspan="<%= list_of_assignment_range_data.weekly[i] %>">Minggu Ke-<%= i+1 %></th>
                            <% } %>
                        </tr>
        
                        <tr>
                            <!-- Task Count -->
                            <% for(let j = 0; j < list_of_assignment_range_data.weekly.length; j++) {%>
                                <% for(let i = 0; i < list_of_assignment_range_data.weekly[j]; i++) {%>
                                    <th class="home_content_table_<%= j+1 %>">Tugas <%= i+1 %></th>
                                <% } %>
                            <% } %>
                        </tr>
        
                        <tr>
                            <!-- Task Name -->
                            <% k = 0 %>
                            <% for(let j = 0; j < list_of_assignment_range_data.weekly.length; j++) {%>
                                <% for(let i = 0; i < list_of_assignment_range_data.weekly[j]; i++) {%>
                                    <th class="home_content_table_<%= j+1 %>"><%= list_of_assignment_data[k].assignment_lesson_name %><%= list_of_assignment_data[k].assignment_lesson_count %></th>
                                    <% k += 1%>
                                <% } %>
                            <% } %>
                        </tr>
        
                    </thead>
        
                    <tbody>
                        <!-- Content -->
                            <% for(let i = 0; i < list_of_student_data.length; i++) {%>
                                <tr>
                                    <!-- ID & Name -->
                                        <td><%= list_of_student_data[i].student_id %>.</td>
                                        <td id="td_text_align_left"><%= list_of_student_data[i].student_name %></td>
            
                                    <!-- Report -->
                                    <% l = 0 %>
                                    <% for(let j = 0; j < list_of_assignment_range_data.weekly.length; j++) {%>
                                        <% for(let k = 0; k < list_of_assignment_range_data.weekly[j]; k++) {%>
                                            <% if (list_of_student_data[i].student_assignment_done[l] == "NON-MUS") {%>
                                                <td class="home_content_table_<%= j+1 %>" style="font-family: 'Roboto';"><%= list_of_student_data[i].student_assignment_done[l] %></td> 
                                                <% l += 1 %>
                                            <% } else {%>
                                                <td class="home_content_table_<%= j+1 %>" style="font-family: 'Wingding';"><%= list_of_student_data[i].student_assignment_done[l] %></td> 
                                                <% l += 1 %>
                                            <% } %>
                                            
                                        <% } %>
                                    <% } %>
                                </tr>
                            <% } %>
                    </tbody>
        
                </table>
        
            </div>
        
        </div>

        <script>
            function disable_report(){
                for(let i = 0; i < parseInt("<%= list_of_assignment_range_data.weekly.length %>"); i++){
                    let elements = document.getElementsByClassName(`home_content_table_${i+1}`)
                    for(let i = 0; i < elements.length; i++){
                        elements[i].classList.add("home_content_table_disable");
                    }
                }
                
            }

            function enable_report(type, number){
                number = parseInt(number)

                if (type == "W") {
                    let elements = document.getElementsByClassName(`home_content_table_${number}`)
                    for(let i = 0; i < elements.length; i++){
                        elements[i].classList.remove("home_content_table_disable");
                    }
                }

                if (type == "M") {
                    let weeks_in_month = "<%= list_of_assignment_range_data.weeks_in_month %>".split(",");
                    
                    if (number == 2){
                        for(let j = 6; j < 11; j++){
                            let elements = document.getElementsByClassName(`home_content_table_${j}`)
                            for(let i = 0; i < elements.length; i++){
                                elements[i].classList.remove("home_content_table_disable");
                            }
                        }

                    } else {
                        for(let j = weeks_in_month[number-1]; j < weeks_in_month[number]; j++){
                            let elements = document.getElementsByClassName(`home_content_table_${j}`)
                            for(let i = 0; i < elements.length; i++){
                                elements[i].classList.remove("home_content_table_disable");
                            }
                        }
                    }
                }
                
                if (type == "C") {
                    for(let j = 0; j < parseInt("<%= list_of_assignment_range_data.weekly.length %>"); j++){
                        let elements = document.getElementsByClassName(`home_content_table_${j+1}`)
                        for(let i = 0; i < elements.length; i++){
                            elements[i].classList.remove("home_content_table_disable");
                        }
                    }
                }
            }

            function option_box(){
                let option_box_value = document.getElementById("home_content_option_box").value;
                let option_box_value_type = option_box_value.replace(/[0-9]/g, '')
                let option_box_value_number = option_box_value.replace(/[A-Z]/g, '')

                disable_report()
                enable_report(option_box_value_type, option_box_value_number)
            }

            disable_report()
            enable_report("W", "<%= list_of_assignment_range_data.weekly.length%>")

        </script>
        
    </body>

</html>